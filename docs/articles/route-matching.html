<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="supermetroid">
<title>route-matching • supermetroid</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="route-matching">
<meta property="og:description" content="supermetroid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">supermetroid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/route-graph.html">route-graph</a>
    <a class="dropdown-item" href="../articles/route-matching.html">route-matching</a>
    <a class="dropdown-item" href="../articles/sio.html">sio</a>
    <a class="dropdown-item" href="../articles/splits.html">splits</a>
    <a class="dropdown-item" href="../articles/src.html">src</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>route-matching</h1>
            
      
      
      <div class="d-none name"><code>route-matching.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://softloud.github.io/supermetroid/">supermetroid</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">306</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="identify-number-of-routes">Identify number of routes<a class="anchor" aria-label="anchor" href="#identify-number-of-routes"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"route_math.jpg"</span><span class="op">)</span></span></code></pre></div>
<p><img src="route_math.jpg" width="80%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get routes</span></span>
<span><span class="va">run_routes</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">sio_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># ensure data is arranged by run, ordered by segment time</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">run_id</span>, <span class="va">realtime_end_ms</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># why is player name a list?</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>player_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">player_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># filter to common splits shared by players</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">supermetroid_label</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">player_name</span>, <span class="va">supermetroid_label</span>, <span class="va">run_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">run_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># create a list-column of label dataframes</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">supermetroid_label</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>route <span class="op">=</span> <span class="va">data</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">run_routes</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   run_id [6]</span></span></span>
<span><span class="co">#&gt;   player_name run_id route            </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> mchan338    100x   <span style="color: #949494;">&lt;tibble [18 × 1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> tm9001      105d   <span style="color: #949494;">&lt;tibble [1 × 1]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> tm9001      10a5   <span style="color: #949494;">&lt;tibble [1 × 1]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> NaN         12qr   <span style="color: #949494;">&lt;tibble [12 × 1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> NaN         12qs   <span style="color: #949494;">&lt;tibble [12 × 1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> NaN         12qt   <span style="color: #949494;">&lt;tibble [12 × 1]&gt;</span></span></span>
<span></span>
<span><span class="co"># get distinct routes and their corresponding run_ids</span></span>
<span><span class="va">distinct_routes</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">run_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">route</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>.key <span class="op">=</span> <span class="st">"run_id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>route_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"route "</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">route_id</span>, <span class="va">route</span>, <span class="va">run_id</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">distinct_routes</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   route_id route             run_id          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> route  1 <span style="color: #949494;">&lt;tibble [18 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [9 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> route  2 <span style="color: #949494;">&lt;tibble [1 × 1]&gt;</span>  <span style="color: #949494;">&lt;tibble [2 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> route  3 <span style="color: #949494;">&lt;tibble [12 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> route  4 <span style="color: #949494;">&lt;tibble [16 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [3 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> route  5 <span style="color: #949494;">&lt;tibble [9 × 1]&gt;</span>  <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> route  6 <span style="color: #949494;">&lt;tibble [7 × 1]&gt;</span>  <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># will use these data in route-graph vignette</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">distinct_routes</span><span class="op">)</span></span></code></pre></div>
<p>In these data we have 569 runs that use 211 routes, but subroutes are
considered separate routes. Which isn’t quite what I want, i.e., a route
containing a single label is considered distinct from every other route
that it is a label from.</p>
<p>We want to know the number of classes of route, that contain every
subroute. Single labels can’t be considered (except via classification,
I’m thinking some kind of centroid thing).</p>
<ul class="task-list">
<li>
<input type="checkbox">todo single label analysis to classify by
routes</li>
</ul>
<p>But here we are to do the easy routes, i.e., route = a,b,d, should be
considered the same as route a,b,c,d, instead of different, which the
211 routes counts. So, how many actual routes are represented, and how
many runs can we not classify?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">viable_routes</span> <span class="op">&lt;-</span></span>
<span>  <span class="co"># filter out routes of length 1</span></span>
<span>  <span class="va">distinct_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>route_length <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">route</span>, <span class="va">nrow</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">route_length</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">viable_routes</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   route_id route             run_id           route_length</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> route  1 <span style="color: #949494;">&lt;tibble [18 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [9 × 2]&gt;</span>           18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> route  3 <span style="color: #949494;">&lt;tibble [12 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span>           12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> route  4 <span style="color: #949494;">&lt;tibble [16 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [3 × 2]&gt;</span>           16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> route  5 <span style="color: #949494;">&lt;tibble [9 × 1]&gt;</span>  <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span>            9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> route  6 <span style="color: #949494;">&lt;tibble [7 × 1]&gt;</span>  <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span>            7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> route  7 <span style="color: #949494;">&lt;tibble [10 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span>           10</span></span></code></pre></div>
<p>Filtering by routes greater than 1, we have 206 different routes and
subroutes.</p>
<div class="section level3">
<h3 id="identifying-if-one-route-is-a-subset-and-same-permutation-of-another">Identifying if one route is a subset and same permutation of
another<a class="anchor" aria-label="anchor" href="#identifying-if-one-route-is-a-subset-and-same-permutation-of-another"></a>
</h3>
<p>We want to compare two arbitrary routes, <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>, and ask is <span class="math inline">\(r_1\)</span> a subroute of <span class="math inline">\(r_2\)</span>?</p>
<p>Choose two routes. We know that two runs with routes the same size
and with the same size are already collapsed by the
<code>nest</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">two_routes</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">viable_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   route_id   route             run_id           route_length</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> route  182 <span style="color: #949494;">&lt;tibble [6 × 1]&gt;</span>  <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span>            6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> route  105 <span style="color: #949494;">&lt;tibble [10 × 1]&gt;</span> <span style="color: #949494;">&lt;tibble [1 × 2]&gt;</span>           10</span></span></code></pre></div>
<p>Now assign the first of the longest route to primary route, and the
other route to the possible subroute of the comparison route.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">comparison_route</span> <span class="op">&lt;-</span> <span class="va">two_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">route_length</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">route_length</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">route_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "route  105"</span></span>
<span></span>
<span><span class="op">(</span><span class="va">possible_subroute</span> <span class="op">&lt;-</span> <span class="va">two_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">route</span> <span class="op">!=</span> <span class="va">comparison_route</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">route_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "route  182" "route  105"</span></span></code></pre></div>
<p>If the two routes are the same length, but in a different order, they
are considered distinct routes, that is, <span class="math inline">\(r_1\)</span> is not a subroute of <span class="math inline">\(r_2\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check if the two routes are the same length</span></span>
<span><span class="va">two_routes</span><span class="op">$</span><span class="va">route_length</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">two_routes</span><span class="op">$</span><span class="va">route_length</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Since the routes are not of the same length, we need to check if
<span class="math inline">\(r_1\)</span>, that is
<code>possible_subroute</code> is a subroute of <span class="math inline">\(r_2\)</span>, <code>comparison_route</code>.</p>
<p>Let’s inspect the routes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">route</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 1</span></span></span>
<span><span class="co">#&gt;   supermetroid_label</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> bombs             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> varia suit        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> grapple beam      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> space jump        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> screw attack      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> golden 4          </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 1</span></span></span>
<span><span class="co">#&gt;    supermetroid_label</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> bombs             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> charge beam       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> varia suit        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> speed booster     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> grapple beam      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gravity suit      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> space jump        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> plasma beam       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ice beam          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> screw attack</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-if-routes-are-in-the-same-order">Check if routes are in the same order<a class="anchor" aria-label="anchor" href="#check-if-routes-are-in-the-same-order"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># figure out comparable ordering of routes</span></span>
<span></span>
<span><span class="va">pivoted_routes</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">two_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">route_length</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">route</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">route_id</span>, <span class="va">supermetroid_label</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">route_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>route_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>route_label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">route_id</span> <span class="op">==</span> <span class="va">comparison_route</span>, </span>
<span>                                 <span class="st">"comparison_route"</span>, <span class="st">"possible_subroute"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">route_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">route_label</span>, values_from <span class="op">=</span> <span class="va">route_order</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inspect</span></span>
<span><span class="va">pivoted_routes</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    supermetroid_label comparison_route possible_subroute</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> bombs                             1                 1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> charge beam                       2                <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> varia suit                        3                 2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> speed booster                     4                <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> grapple beam                      5                 3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> gravity suit                      6                <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> space jump                        7                 4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> plasma beam                       8                <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ice beam                          9                <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> screw attack                     10                 5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> golden 4                         <span style="color: #BB0000;">NA</span>                 6</span></span>
<span></span>
<span><span class="co"># now filter for overlapping events</span></span>
<span><span class="va">compared_routes</span> <span class="op">&lt;-</span> <span class="va">pivoted_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># filter </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">comparison_route</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">possible_subroute</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># arrange by possible subroute </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">possible_subroute</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># and assign order</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>possible_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># arrange by comparison route order</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">comparison_route</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>comparison_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>           order_eq <span class="op">=</span> <span class="va">possible_order</span> <span class="op">==</span> <span class="va">comparison_order</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inspect</span></span>
<span><span class="va">compared_routes</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   supermetroid_label comparison_route possible_subroute possible_order</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> bombs                             1                 1              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> varia suit                        3                 2              2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> grapple beam                      5                 3              3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> space jump                        7                 4              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> screw attack                     10                 5              5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: comparison_order &lt;int&gt;, order_eq &lt;lgl&gt;</span></span></span>
<span></span>
<span></span>
<span><span class="co"># now check to see if they're all true</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">pivoted_routes</span><span class="op">$</span><span class="va">order_eq</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `order_eq`.</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># check to see if all elements of possible subroute are in compared route</span></span>
<span><span class="co"># otherwise, could match one to many for route classes</span></span></code></pre></div>
<p>Now we know if they have the same overlapping subroutes, and if
<code>possible_subroute</code> has elements that
<code>comparison_route</code> has.</p>
</div>
<div class="section level3">
<h3 id="identify-the-one-to-many-subroutes">Identify the one to many subroutes<a class="anchor" aria-label="anchor" href="#identify-the-one-to-many-subroutes"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"route_many_to_one.jpg"</span><span class="op">)</span></span></code></pre></div>
<p><img src="route_many_to_one.jpg" width="80%"></p>
<p>If a subroute maps one to many, we need to disregard it.</p>
<p>Need a list of a every combinatorial pairing.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">viable_route_id</span> <span class="op">&lt;-</span> <span class="va">viable_routes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">route_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_id_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">viable_route_id</span>, <span class="va">viable_route_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>comparison_route <span class="op">=</span> <span class="va">Var1</span>, possible_subroute <span class="op">=</span> <span class="va">Var2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">comparison_route</span> <span class="op">!=</span> <span class="va">possible_subroute</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">comparison_route</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    comparison_id <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span></span>
<span>      <span class="st">"c "</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">comparison_route</span>, <span class="st">"\\d+"</span><span class="op">)</span>,</span>
<span>      <span class="st">" p "</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">possible_subroute</span>, <span class="st">"\\d+"</span><span class="op">)</span> </span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># take a look at combinations</span></span>
<span><span class="va">comparison_id_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   comparison_route possible_subroute comparison_id</span></span>
<span><span class="co">#&gt; 1         route  1          route  3       c 1 p 3</span></span>
<span><span class="co">#&gt; 2         route  1          route  4       c 1 p 4</span></span>
<span><span class="co">#&gt; 3         route  1          route  5       c 1 p 5</span></span>
<span><span class="co">#&gt; 4         route  1          route  6       c 1 p 6</span></span>
<span><span class="co">#&gt; 5         route  1          route  7       c 1 p 7</span></span>
<span><span class="co">#&gt; 6         route  1          route  8       c 1 p 8</span></span>
<span></span>
<span></span>
<span><span class="co"># how many combinations would we expect?</span></span>
<span><span class="co"># number of routes * 1 less number of routes </span></span>
<span><span class="co"># because we won't compare a route with itself</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">viable_route_id</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">viable_route_id</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 42230</span></span>
<span></span>
<span><span class="co"># comfirm number of comparisons</span></span>
<span><span class="va">comparison_id_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 42230</span></span>
<span></span>
<span><span class="co"># whoa combinatorics! </span></span></code></pre></div>
<p>Now we need to compare each route. We want to apply a function that
calls each route and applies a comparison. We need to return a few
pieces of information.</p>
<p>Probably some kind of <code>map_df</code> that returns: 1. if
<code>possible_classroute</code> (because it might not be a subroute) 2.
lengths of two routes 3. if <code>possible_classroute</code> is an
absolute subroute 4. if <code>possible_classroute</code></p>
<p>We need to find out if <code>possible_classroute</code></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Charles Gray.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
